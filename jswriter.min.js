!function(t){t.fn.JSWriter=function(e){function r(t,e){var r=c.get(0).selectionStart,i=c.get(0).selectionEnd,o=c.val();c.val(o.substring(0,r)+t+o.substring(r,i)+e+o.substring(i))}function i(){w.html(e.textfilter(c.val()))}function o(e){var r,i=t('<style id="jswriter-styles"></styles'),o="";"object"!=typeof e&&(e=a());for(selector in e){o+=selector+"{",r=e[selector];for(prop in r)o+=prop+":"+r[prop]+";";o+="}"}i.text(o),t("head").append(i)}function a(){var t={".jswriter .tabs li":{cursor:"pointer"},".jswriter .editor":{border:"1px solid #aaa",height:"500px"},".jswriter .editor-window":{height:"100%",width:"100%","float":"left","overflow-y":"hidden"},".jswriter .editor-text":{padding:"15px"},".jswriter .editor-text:hover":{"overflow-y":"auto"},".jswriter .controls":{"list-style":"none","padding-left":"0","margin-bottom":"0","background-color":"#eee"},".jswriter .controls:after":{content:'" "',display:"block",clear:"both"},".jswriter .controls li":{cursor:"pointer","float":"left","background-color":"#fff",border:"1px solid #666","text-align":"center","line-height":"20px",margin:"2px",width:"20px",height:"20px"},".jswriter .controls li:hover":{"background-color":"#eee"},".jswriter .controls .bold":{"font-weight":"bold"},".jswriter .controls .italic":{"font-style":"italic"},".jswriter textarea":{width:"100%",height:"474px"},".jswriter .editor.both .editor-window":{width:"49.5%"},".jswriter .text-write":{border:"0px",background:"#d8d8d8",resize:"none"},".jswriter .separator":{background:"#aaa","float":"left",width:"1%",height:"100%"},".jswriter .editor.preview .separator, .jswriter .editor.preview .text-write":{display:"none"},".jswriter .editor.write .separator, .jswriter .editor.write .text-preview":{display:"none"}};return e.usingBootstrap||(t[".jswriter .editor-tabs"]={"list-style":"none","padding-left":"0","margin-bottom":"0"},t[".jswriter .editor-tabs::after"]={display:"table",content:'" "',clear:"both"},t[".jswriter .editor-tabs li"]={"float":"left",display:"block"},t[".jswriter .editor-tabs a"]={display:"block",padding:"8px",border:"1px solid #aaa","background-color":"#eee","font-size":"2rem","text-decoration":"none"},t[".jswriter .editor-tabs a:hover"]={"background-color":"#aaa"},t[".jswriter .active a"]={"background-color":"#aaa"}),t}var s={text:"",styles:!0,usingBootstrap:!0,textfilter:function(t){return t}},e=t.extend(s,e);e.styles&&0==t("#jswriter-styles").length&&o(e.styles);var l=t(this),n=t('<ul class="tabs editor-tabs"><li data-mode="both" class="active"><a>Both</a></li><li data-mode="write"><a>Write</a></li><li data-mode="preview"><a>Preview</a></li></ul>'),d=t('<div class="editor both"><div class="text-write editor-window"><ul data-action="controls" class="controls"><li data-action="bold" class="bold">B</li><li data-action="italic" class="italic">I</li></ul><textarea name="text_markdown" class="text-write editor-text"></textarea></div><div class="separator"></div><div class="text-preview editor-text editor-window"></div></div>'),c=d.find(".text-write textarea"),w=d.find(".text-preview");e.usingBootstrap&&(n.removeClass("editor-tabs"),n.addClass("nav"),n.addClass("nav-tabs")),l.addClass("jswriter"),l.append(n),l.append(d);var p="both";return n.on("click","li",function(){var e=t(this),r=e.data("mode");r!=p&&(d.removeClass(p),d.addClass(r),n.find(".active").removeClass("active"),e.addClass("active"),p=r)}),c.on("keydown",function(t){if(9==(t.keyCode||t.which)){t.preventDefault();var e=c.get(0).selectionStart,r=c.get(0).selectionEnd;c.val(c.val().substring(0,e)+"	"+c.val().substring(r)),c.get(0).selectionStart=c.get(0).selectionEnd=e+1}}),c.on("keyup",i),d.find(".controls").on("click","li",function(){var e=t(this).data("action");"bold"==e?r("<strong>","</strong>"):"italic"==e&&r("<em>","</em>"),i()}),e.text.length>0&&(c.text(e.text),w.html(e.textfilter(e.text))),this.getTexts=function(){var t=c.val();return{write:t,preview:e.textfilter(t)}},this}}(jQuery);